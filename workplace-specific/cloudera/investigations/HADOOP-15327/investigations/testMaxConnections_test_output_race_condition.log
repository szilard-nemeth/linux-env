2021-06-07 23:57:01,543 DEBUG [Time-limited test] logging.InternalLoggerFactory (InternalLoggerFactory.java:useSlf4JLoggerFactory(63)) - Using SLF4J as the default logging framework
2021-06-07 23:57:01,546 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:isOsx0(1074)) - Platform: MacOS
2021-06-07 23:57:01,548 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:explicitNoUnsafeCause0(433)) - -Dio.netty.noUnsafe: false
2021-06-07 23:57:01,548 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:javaVersion0(927)) - Java version: 8
2021-06-07 23:57:01,550 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(131)) - sun.misc.Unsafe.theUnsafe: available
2021-06-07 23:57:01,550 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(155)) - sun.misc.Unsafe.copyMemory: available
2021-06-07 23:57:01,551 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(193)) - java.nio.Buffer.address: available
2021-06-07 23:57:01,552 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(258)) - direct buffer constructor: available
2021-06-07 23:57:01,553 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(332)) - java.nio.Bits.unaligned: available, true
2021-06-07 23:57:01,553 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(397)) - jdk.internal.misc.Unsafe.allocateUninitializedArray(int): unavailable prior to Java9
2021-06-07 23:57:01,553 DEBUG [Time-limited test] internal.PlatformDependent0 (PlatformDependent0.java:<clinit>(419)) - java.nio.DirectByteBuffer.<init>(long, int): available
2021-06-07 23:57:01,553 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:unsafeUnavailabilityCause0(1106)) - sun.misc.Unsafe: available
2021-06-07 23:57:01,554 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:tmpdir0(1227)) - -Dio.netty.tmpdir: /var/folders/nn/mkv5bwbd2fg8v8ztz5swpq980000gn/T (java.io.tmpdir)
2021-06-07 23:57:01,554 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:bitMode0(1306)) - -Dio.netty.bitMode: 64 (sun.arch.data.model)
2021-06-07 23:57:01,555 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:<clinit>(178)) - -Dio.netty.maxDirectMemory: 2075918336 bytes
2021-06-07 23:57:01,555 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:<clinit>(185)) - -Dio.netty.uninitializedArrayAllocationThreshold: -1
2021-06-07 23:57:01,557 DEBUG [Time-limited test] internal.CleanerJava6 (CleanerJava6.java:<clinit>(92)) - java.nio.ByteBuffer.cleaner(): available
2021-06-07 23:57:01,558 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:<clinit>(205)) - -Dio.netty.noPreferDirect: false
2021-06-07 23:57:01,608 DEBUG [Time-limited test] internal.InternalThreadLocalMap (InternalThreadLocalMap.java:<clinit>(83)) - -Dio.netty.threadLocalMap.stringBuilder.initialSize: 1024
2021-06-07 23:57:01,608 DEBUG [Time-limited test] internal.InternalThreadLocalMap (InternalThreadLocalMap.java:<clinit>(86)) - -Dio.netty.threadLocalMap.stringBuilder.maxSize: 4096
2021-06-07 23:57:01,615 DEBUG [Time-limited test] util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(44)) - Trying to load the custom-built native-hadoop library...
2021-06-07 23:57:01,616 DEBUG [Time-limited test] util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(53)) - Failed to load native-hadoop with error: java.lang.UnsatisfiedLinkError: no hadoop in java.library.path
2021-06-07 23:57:01,617 DEBUG [Time-limited test] util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(54)) - java.library.path=/Users/snemeth/Library/Java/Extensions:/Library/Java/Extensions:/Network/Library/Java/Extensions:/System/Library/Java/Extensions:/usr/lib/java:.
2021-06-07 23:57:01,617 WARN  [Time-limited test] util.NativeCodeLoader (NativeCodeLoader.java:<clinit>(60)) - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2021-06-07 23:57:01,648 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableGaugeInt org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleConnections with annotation @org.apache.hadoop.metrics2.annotation.Metric(always=false, sampleName=Ops, valueName=Time, about=, interval=10, type=DEFAULT, value=[# of current shuffle connections])
2021-06-07 23:57:01,652 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableCounterLong org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleOutputBytes with annotation @org.apache.hadoop.metrics2.annotation.Metric(always=false, sampleName=Ops, valueName=Time, about=, interval=10, type=DEFAULT, value=[Shuffle output in bytes])
2021-06-07 23:57:01,653 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableCounterInt org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleOutputsFailed with annotation @org.apache.hadoop.metrics2.annotation.Metric(always=false, sampleName=Ops, valueName=Time, about=, interval=10, type=DEFAULT, value=[# of failed shuffle outputs])
2021-06-07 23:57:01,653 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableCounterInt org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleOutputsOK with annotation @org.apache.hadoop.metrics2.annotation.Metric(always=false, sampleName=Ops, valueName=Time, about=, interval=10, type=DEFAULT, value=[# of succeeeded shuffle outputs])
2021-06-07 23:57:01,654 DEBUG [Time-limited test] impl.MetricsSystemImpl (MetricsSystemImpl.java:register(231)) - ShuffleMetrics, Shuffle output metrics
2021-06-07 23:57:01,656 DEBUG [Time-limited test] service.AbstractService (AbstractService.java:enterState(444)) - Service: mapreduce_shuffle entered state INITED
2021-06-07 23:57:01,677 DEBUG [Time-limited test] util.Shell (Shell.java:isSetsidSupported(804)) - setsid is not available on this machine. So not using it.
2021-06-07 23:57:01,677 DEBUG [Time-limited test] util.Shell (Shell.java:isSetsidSupported(822)) - setsid exited with exit code 0
2021-06-07 23:57:01,684 DEBUG [Time-limited test] channel.MultithreadEventLoopGroup (MultithreadEventLoopGroup.java:<clinit>(44)) - -Dio.netty.eventLoopThreads: 24
2021-06-07 23:57:01,696 DEBUG [Time-limited test] nio.NioEventLoop (NioEventLoop.java:<clinit>(106)) - -Dio.netty.noKeySetOptimization: false
2021-06-07 23:57:01,696 DEBUG [Time-limited test] nio.NioEventLoop (NioEventLoop.java:<clinit>(107)) - -Dio.netty.selectorAutoRebuildThreshold: 512
2021-06-07 23:57:01,709 DEBUG [Time-limited test] internal.PlatformDependent (PlatformDependent.java:<clinit>(967)) - org.jctools-core.MpscChunkedArrayQueue: available
2021-06-07 23:57:01,722 DEBUG [Time-limited test] service.AbstractService (AbstractService.java:serviceInit(314)) - Config has been overridden during init
2021-06-07 23:57:01,849 INFO  [Time-limited test] mapred.IndexCache (IndexCache.java:<init>(47)) - IndexCache created with max memory = 10485760
2021-06-07 23:57:02,027 DEBUG [Time-limited test] channel.DefaultChannelId (DefaultChannelId.java:<clinit>(79)) - -Dio.netty.processId: 88427 (auto-detected)
2021-06-07 23:57:02,030 DEBUG [Time-limited test] util.NetUtil (NetUtil.java:<clinit>(135)) - -Djava.net.preferIPv4Stack: true
2021-06-07 23:57:02,030 DEBUG [Time-limited test] util.NetUtil (NetUtil.java:<clinit>(136)) - -Djava.net.preferIPv6Addresses: false
2021-06-07 23:57:02,033 DEBUG [Time-limited test] util.NetUtilInitializations (NetUtilInitializations.java:determineLoopback(129)) - Loopback interface: lo0 (lo0, 127.0.0.1)
2021-06-07 23:57:02,035 DEBUG [Time-limited test] util.NetUtil (NetUtil.java:run(187)) - Failed to get SOMAXCONN from sysctl and file /proc/sys/net/core/somaxconn. Default: 128
2021-06-07 23:57:02,037 DEBUG [Time-limited test] channel.DefaultChannelId (DefaultChannelId.java:<clinit>(101)) - -Dio.netty.machineId: 3c:22:fb:ff:fe:c0:80:8b (auto-detected)
2021-06-07 23:57:02,059 DEBUG [Time-limited test] util.ResourceLeakDetector (ResourceLeakDetector.java:<clinit>(129)) - -Dio.netty.leakDetection.level: simple
2021-06-07 23:57:02,059 DEBUG [Time-limited test] util.ResourceLeakDetector (ResourceLeakDetector.java:<clinit>(130)) - -Dio.netty.leakDetection.targetRecords: 4
2021-06-07 23:57:02,127 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(155)) - -Dio.netty.allocator.numHeapArenas: 20
2021-06-07 23:57:02,127 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(156)) - -Dio.netty.allocator.numDirectArenas: 20
2021-06-07 23:57:02,127 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(158)) - -Dio.netty.allocator.pageSize: 8192
2021-06-07 23:57:02,128 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(163)) - -Dio.netty.allocator.maxOrder: 11
2021-06-07 23:57:02,128 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(167)) - -Dio.netty.allocator.chunkSize: 16777216
2021-06-07 23:57:02,128 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(168)) - -Dio.netty.allocator.smallCacheSize: 256
2021-06-07 23:57:02,128 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(169)) - -Dio.netty.allocator.normalCacheSize: 64
2021-06-07 23:57:02,128 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(170)) - -Dio.netty.allocator.maxCachedBufferCapacity: 32768
2021-06-07 23:57:02,128 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(171)) - -Dio.netty.allocator.cacheTrimInterval: 8192
2021-06-07 23:57:02,129 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(172)) - -Dio.netty.allocator.cacheTrimIntervalMillis: 0
2021-06-07 23:57:02,129 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(173)) - -Dio.netty.allocator.useCacheForAllThreads: true
2021-06-07 23:57:02,129 DEBUG [Time-limited test] buffer.PooledByteBufAllocator (PooledByteBufAllocator.java:<clinit>(174)) - -Dio.netty.allocator.maxCachedByteBuffersPerChunk: 1023
2021-06-07 23:57:02,153 DEBUG [Time-limited test] buffer.ByteBufUtil (ByteBufUtil.java:<clinit>(87)) - -Dio.netty.allocator.type: pooled
2021-06-07 23:57:02,153 DEBUG [Time-limited test] buffer.ByteBufUtil (ByteBufUtil.java:<clinit>(96)) - -Dio.netty.threadLocalDirectBufferSize: 0
2021-06-07 23:57:02,153 DEBUG [Time-limited test] buffer.ByteBufUtil (ByteBufUtil.java:<clinit>(99)) - -Dio.netty.maxThreadLocalCharBufferSize: 16384
2021-06-07 23:57:02,180 INFO  [Time-limited test] mapred.ShuffleHandler (ShuffleHandler.java:serviceStart(568)) - mapreduce_shuffle listening on port 51799
2021-06-07 23:57:02,181 DEBUG [Time-limited test] service.AbstractService (AbstractService.java:start(198)) - Service mapreduce_shuffle is started
2021-06-07 23:57:02,284 DEBUG [ShuffleHandler Netty Worker #1] buffer.AbstractByteBuf (AbstractByteBuf.java:<clinit>(63)) - -Dio.netty.buffer.checkAccessible: true
2021-06-07 23:57:02,284 DEBUG [ShuffleHandler Netty Worker #1] buffer.AbstractByteBuf (AbstractByteBuf.java:<clinit>(64)) - -Dio.netty.buffer.checkBounds: true
2021-06-07 23:57:02,285 DEBUG [ShuffleHandler Netty Worker #1] util.ResourceLeakDetectorFactory (ResourceLeakDetectorFactory.java:newResourceLeakDetector(196)) - Loaded default ResourceLeakDetector: io.netty.util.ResourceLeakDetector@597c27df
2021-06-07 23:57:02,299 DEBUG [ShuffleHandler Netty Worker #2] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(912)) - accepted connections=1
2021-06-07 23:57:02,299 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(912)) - accepted connections=1
2021-06-07 23:57:02,299 DEBUG [ShuffleHandler Netty Worker #1] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(912)) - accepted connections=1
2021-06-07 23:57:02,300 INFO  [ShuffleHandler Netty Worker #1] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(915)) - Current number of shuffle connections (3) is greater than or equal to the max allowed shuffle connections (3)
2021-06-07 23:57:02,314 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(929)) - added channel: [id: 0x654c3251, L:/127.0.0.1:51799 - R:/127.0.0.1:51800]. accepted size: 3
2021-06-07 23:57:02,314 DEBUG [ShuffleHandler Netty Worker #2] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(929)) - added channel: [id: 0xb85b0b5d, L:/127.0.0.1:51799 - R:/127.0.0.1:51802]. accepted size: 2
2021-06-07 23:57:02,315 DEBUG [ShuffleHandler Netty Worker #1] util.Recycler (Recycler.java:<clinit>(103)) - -Dio.netty.recycler.maxCapacityPerThread: 4096
2021-06-07 23:57:02,315 DEBUG [ShuffleHandler Netty Worker #1] util.Recycler (Recycler.java:<clinit>(104)) - -Dio.netty.recycler.maxSharedCapacityFactor: 2
2021-06-07 23:57:02,315 DEBUG [ShuffleHandler Netty Worker #1] util.Recycler (Recycler.java:<clinit>(105)) - -Dio.netty.recycler.linkCapacity: 16
2021-06-07 23:57:02,315 DEBUG [ShuffleHandler Netty Worker #1] util.Recycler (Recycler.java:<clinit>(106)) - -Dio.netty.recycler.ratio: 8
2021-06-07 23:57:02,316 DEBUG [ShuffleHandler Netty Worker #1] util.Recycler (Recycler.java:<clinit>(107)) - -Dio.netty.recycler.delayedQueue.ratio: 8
2021-06-07 23:57:02,346 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(966)) - RECV: /mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_0_0
  mapId: [attempt_12345_1_m_0_0]
  reduceId: [1]
  jobId: [job_12345_1]
  keepAlive: false

java.io.IOException: Server returned HTTP response code: 429 for URL: http://127.0.0.1:51799/mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0

	at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1900)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1498)
	at org.apache.hadoop.mapred.TestShuffleHandler.testMaxConnections(TestShuffleHandler.java:677)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:288)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:282)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:748)

