2021-06-22 23:23:02,690 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableGaugeInt org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleConnections with annotation @org.apache.hadoop.metrics2.annotation.Metric(sampleName=Ops, always=false, valueName=Time, about=, interval=10, type=DEFAULT, value=[# of current shuffle connections])
2021-06-22 23:23:02,690 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableCounterLong org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleOutputBytes with annotation @org.apache.hadoop.metrics2.annotation.Metric(sampleName=Ops, always=false, valueName=Time, about=, interval=10, type=DEFAULT, value=[Shuffle output in bytes])
2021-06-22 23:23:02,690 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableCounterInt org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleOutputsFailed with annotation @org.apache.hadoop.metrics2.annotation.Metric(sampleName=Ops, always=false, valueName=Time, about=, interval=10, type=DEFAULT, value=[# of failed shuffle outputs])
2021-06-22 23:23:02,690 DEBUG [Time-limited test] lib.MutableMetricsFactory (MutableMetricsFactory.java:newForField(43)) - field org.apache.hadoop.metrics2.lib.MutableCounterInt org.apache.hadoop.mapred.ShuffleHandler$ShuffleMetrics.shuffleOutputsOK with annotation @org.apache.hadoop.metrics2.annotation.Metric(sampleName=Ops, always=false, valueName=Time, about=, interval=10, type=DEFAULT, value=[# of succeeeded shuffle outputs])
2021-06-22 23:23:02,690 DEBUG [Time-limited test] impl.MetricsSystemImpl (MetricsSystemImpl.java:register(231)) - ShuffleMetrics, Shuffle output metrics
2021-06-22 23:23:02,691 DEBUG [Time-limited test] service.AbstractService (AbstractService.java:enterState(444)) - Service: mapreduce_shuffle entered state INITED
2021-06-22 23:23:02,692 DEBUG [Time-limited test] service.AbstractService (AbstractService.java:serviceInit(314)) - Config has been overridden during init
2021-06-22 23:23:02,693 INFO  [Time-limited test] mapred.IndexCache (IndexCache.java:<init>(47)) - IndexCache created with max memory = 10485760
2021-06-22 23:23:02,694 INFO  [Time-limited test] mapred.ShuffleHandler (ShuffleHandler.java:serviceStart(582)) - mapreduce_shuffle listening on port 8088
2021-06-22 23:23:02,695 DEBUG [Time-limited test] service.AbstractService (AbstractService.java:start(198)) - Service mapreduce_shuffle is started
2021-06-22 23:23:02,695 DEBUG [Time-limited test] mapred.TestShuffleHandler (TestShuffleHandler.java:connectToUrls(518)) - Will connect to URLs: [http://127.0.0.1:8088/mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0,attempt_12345_1_m_1_0&keepAlive=true, http://127.0.0.1:8088/mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0,attempt_12345_1_m_1_0&keepAlive=true]
2021-06-22 23:23:02,695 DEBUG [Time-limited test] mapred.TestShuffleHandler (TestShuffleHandler.java:connectToUrls(521)) - Connecting to URL: http://127.0.0.1:8088/mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0,attempt_12345_1_m_1_0&keepAlive=true
2021-06-22 23:23:02,697 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(956)) - channelActive
2021-06-22 23:23:02,697 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(973)) - Added channel: [id: 0x9ae9a7fd, L:/127.0.0.1:8088 - R:/127.0.0.1:65194]. Accepted number of connections=1
2021-06-22 23:23:02,698 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(989)) - ***channelRead
2021-06-22 23:23:02,698 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(991)) - ***REQUEST: HttpObjectAggregator$AggregatedFullHttpRequest(decodeResult: success, version: HTTP/1.1, content: CompositeByteBuf(ridx: 0, widx: 0, cap: 0, components=0))
GET /mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0,attempt_12345_1_m_1_0&keepAlive=true HTTP/1.1
name: mapreduce
version: 1.0.0
User-Agent: Java/1.8.0_232b09
Host: 127.0.0.1:8088
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
content-length: 0
2021-06-22 23:23:02,698 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1002)) - Shuffle version: 1.0.0
2021-06-22 23:23:02,698 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1018)) - KeepAliveParam : [true] : true
2021-06-22 23:23:02,698 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1026)) - RECV: /mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0,attempt_12345_1_m_1_0&keepAlive=true
  mapId: [attempt_12345_1_m_1_0, attempt_12345_1_m_1_0]
  reduceId: [1]
  jobId: [job_12345_1]
  keepAlive: true
2021-06-22 23:23:02,824 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:populateHeaders(426)) - HTTP response content length: 3000000
2021-06-22 23:23:02,824 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:setResponseHeaders(1319)) - Content Length in shuffle : 3000000
2021-06-22 23:23:02,824 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:writeToChannel(1139)) - ***Writing Response, channel: 9ae9a7fd
2021-06-22 23:23:02,824 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#write
2021-06-22 23:23:02,824 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#acceptOutboundMessage
2021-06-22 23:23:02,824 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encode
2021-06-22 23:23:02,824 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:encodeInitialLine(46)) - Executing method: LoggingHttpResponseEncoder#encodeInitialLine, response: DefaultHttpResponse(decodeResult: success, version: HTTP/1.1)
HTTP/1.1 200 OK
Content-Length: 3000000
Connection: Keep-Alive
Keep-Alive: timeout=1000
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encodeHeaders
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:lambda$channelRead$2(1098)) - Written HTTP response object successfully
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1107)) - After response
2021-06-22 23:23:02,825 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1109)) - ***LOOP1
2021-06-22 23:23:02,825 DEBUG [Time-limited test] mapred.TestShuffleHandler (TestShuffleHandler.java:connectToUrls(530)) - Opened DataInputStream for connection: 1/2
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:send(350)) - In MapOutputSender#send
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:writeOneHeader(366)) - MapOutputSender#writeOneHeader before WriteAndFlush #1
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#write
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#acceptOutboundMessage
2021-06-22 23:23:02,825 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encode
2021-06-22 23:23:02,826 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:writeOneHeader(368)) - MapOutputSender#writeOneHeader after WriteAndFlush #1. outputBufferSize: 30
2021-06-22 23:23:02,839 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:writeHeaderNTimes(376)) - MapOutputSender#writeHeaderNTimes WriteAndFlush big chunk of data, outputBufferSize: 3000000
2021-06-22 23:23:02,839 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#write
2021-06-22 23:23:02,839 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#acceptOutboundMessage
2021-06-22 23:23:02,839 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encode
2021-06-22 23:23:02,844 INFO  [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:perform(967)) - ***Writing response partition: io.netty.channel.DefaultFileRegion@1ee7356c, channel: 9ae9a7fd
2021-06-22 23:23:02,844 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1109)) - ***LOOP2
2021-06-22 23:23:02,844 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:send(350)) - In MapOutputSender#send
2021-06-22 23:23:02,844 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:writeOneHeader(366)) - MapOutputSender#writeOneHeader before WriteAndFlush #1
2021-06-22 23:23:02,844 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:writeOneHeader(368)) - MapOutputSender#writeOneHeader after WriteAndFlush #1. outputBufferSize: 30
2021-06-22 23:23:02,856 DEBUG [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:writeHeaderNTimes(376)) - MapOutputSender#writeHeaderNTimes WriteAndFlush big chunk of data, outputBufferSize: 3000000
2021-06-22 23:23:02,856 INFO  [ShuffleHandler Netty Worker #0] mapred.TestShuffleHandler (TestShuffleHandler.java:perform(967)) - ***Writing response partition: io.netty.channel.DefaultFileRegion@5343f05b, channel: 9ae9a7fd
2021-06-22 23:23:02,857 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelRead(1115)) - ***LOOP ENDED
2021-06-22 23:23:02,857 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:writeLastHttpContentToChannel(1149)) - ***Writing LastHttpContent, channel: 9ae9a7fd
2021-06-22 23:23:02,859 INFO  [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:operationComplete(339)) - ***OPERATION COMPLETE
2021-06-22 23:23:02,859 DEBUG [Time-limited test] mapred.TestShuffleHandler (TestShuffleHandler.java:readDataFromInputStream(564)) - Read total bytes: 3000000
2021-06-22 23:23:02,859 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#write
2021-06-22 23:23:02,859 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#acceptOutboundMessage
2021-06-22 23:23:02,859 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encode
2021-06-22 23:23:02,859 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#write
2021-06-22 23:23:02,859 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#acceptOutboundMessage
2021-06-22 23:23:02,859 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encode
2021-06-22 23:23:02,860 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#write
2021-06-22 23:23:02,860 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#acceptOutboundMessage
2021-06-22 23:23:02,860 DEBUG [ShuffleHandler Netty Worker #0] mapred.LoggingHttpResponseEncoder (LoggingHttpResponseEncoder.java:printExecutingMethod(81)) - Executing method: LoggingHttpResponseEncoder#encode
2021-06-22 23:23:02,862 DEBUG [Time-limited test] mapred.TestShuffleHandler (TestShuffleHandler.java:connectToUrls(521)) - Connecting to URL: http://127.0.0.1:8088/mapOutput?job=job_12345_1&reduce=1&map=attempt_12345_1_m_1_0,attempt_12345_1_m_1_0&keepAlive=true
2021-06-22 23:23:02,863 ERROR [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:exceptionCaught(1473)) - Shuffle error: 
java.io.IOException: Protocol wrong type for socket
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:51)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:408)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:953)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:361)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:713)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:748)
2021-06-22 23:23:02,863 ERROR [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:operationComplete(320)) - Future is unsuccessful. Cause: 
java.io.IOException: Protocol wrong type for socket
	at sun.nio.ch.FileDispatcherImpl.write0(Native Method)
	at sun.nio.ch.SocketDispatcher.write(SocketDispatcher.java:47)
	at sun.nio.ch.IOUtil.writeFromNativeBuffer(IOUtil.java:93)
	at sun.nio.ch.IOUtil.write(IOUtil.java:51)
	at sun.nio.ch.SocketChannelImpl.write(SocketChannelImpl.java:471)
	at io.netty.channel.socket.nio.NioSocketChannel.doWrite(NioSocketChannel.java:408)
	at io.netty.channel.AbstractChannel$AbstractUnsafe.flush0(AbstractChannel.java:953)
	at io.netty.channel.nio.AbstractNioChannel$AbstractNioUnsafe.forceFlush(AbstractNioChannel.java:361)
	at io.netty.channel.nio.NioEventLoop.processSelectedKey(NioEventLoop.java:713)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeysOptimized(NioEventLoop.java:655)
	at io.netty.channel.nio.NioEventLoop.processSelectedKeys(NioEventLoop.java:581)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:493)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:748)
2021-06-22 23:23:02,863 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:operationComplete(321)) - Closing channel
2021-06-22 23:23:02,863 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:exceptionCaught(1463)) - Ignoring closed channel error
java.nio.channels.ClosedChannelException
	at io.netty.handler.stream.ChunkedWriteHandler.discard(ChunkedWriteHandler.java:184)
	at io.netty.handler.stream.ChunkedWriteHandler.doFlush(ChunkedWriteHandler.java:194)
	at io.netty.handler.stream.ChunkedWriteHandler.channelInactive(ChunkedWriteHandler.java:136)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.netty.handler.codec.MessageAggregator.channelInactive(MessageAggregator.java:438)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:389)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:354)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:831)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:497)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:748)
2021-06-22 23:23:02,863 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:exceptionCaught(1463)) - Ignoring closed channel error
java.nio.channels.ClosedChannelException
	at io.netty.handler.stream.ChunkedWriteHandler.discard(ChunkedWriteHandler.java:184)
	at io.netty.handler.stream.ChunkedWriteHandler.doFlush(ChunkedWriteHandler.java:194)
	at io.netty.handler.stream.ChunkedWriteHandler.channelInactive(ChunkedWriteHandler.java:136)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.channel.ChannelInboundHandlerAdapter.channelInactive(ChannelInboundHandlerAdapter.java:81)
	at io.netty.handler.codec.MessageAggregator.channelInactive(MessageAggregator.java:438)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInputClosed(ByteToMessageDecoder.java:389)
	at io.netty.handler.codec.ByteToMessageDecoder.channelInactive(ByteToMessageDecoder.java:354)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.AbstractChannelHandlerContext.fireChannelInactive(AbstractChannelHandlerContext.java:241)
	at io.netty.channel.DefaultChannelPipeline$HeadContext.channelInactive(DefaultChannelPipeline.java:1405)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:262)
	at io.netty.channel.AbstractChannelHandlerContext.invokeChannelInactive(AbstractChannelHandlerContext.java:248)
	at io.netty.channel.DefaultChannelPipeline.fireChannelInactive(DefaultChannelPipeline.java:901)
	at io.netty.channel.AbstractChannel$AbstractUnsafe$8.run(AbstractChannel.java:831)
	at io.netty.util.concurrent.AbstractEventExecutor.safeExecute(AbstractEventExecutor.java:164)
	at io.netty.util.concurrent.SingleThreadEventExecutor.runAllTasks(SingleThreadEventExecutor.java:472)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:497)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:989)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(Thread.java:748)
2021-06-22 23:23:02,863 DEBUG [ShuffleHandler Netty Worker #0] mapred.ShuffleHandler (ShuffleHandler.java:channelInactive(982)) - New value of Accepted number of connections=0
2021-06-22 23:23:02,864 DEBUG [ShuffleHandler Netty Worker #1] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(956)) - channelActive
2021-06-22 23:23:02,864 DEBUG [ShuffleHandler Netty Worker #1] mapred.ShuffleHandler (ShuffleHandler.java:channelActive(973)) - Added channel: [id: 0xe3da1d6b, L:/127.0.0.1:8088 - R:/127.0.0.1:65195]. Accepted number of connections=1
2021-06-22 23:23:02,864 DEBUG [ShuffleHandler Netty Worker #1] mapred.ShuffleHandler (ShuffleHandler.java:channelInactive(982)) - New value of Accepted number of connections=0

java.io.IOException: Invalid Http response

	at sun.net.www.protocol.http.HttpURLConnection.getInputStream0(HttpURLConnection.java:1612)
	at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1498)
	at org.apache.hadoop.mapred.TestShuffleHandler$HttpConnectionHelper.connectToUrls(TestShuffleHandler.java:529)
	at org.apache.hadoop.mapred.TestShuffleHandler.testKeepAliveInternal(TestShuffleHandler.java:993)
	at org.apache.hadoop.mapred.TestShuffleHandler.testKeepAliveMultipleMapAttemptIds(TestShuffleHandler.java:971)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.InvokeMethod.evaluate(InvokeMethod.java:17)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:288)
	at org.junit.internal.runners.statements.FailOnTimeout$CallableStatement.call(FailOnTimeout.java:282)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.lang.Thread.run(Thread.java:748)


java.lang.IllegalStateException: Port is being used: 8088. Current testcase name: testKeepAliveMultipleMapAttemptIds

	at org.apache.hadoop.mapred.TestShuffleHandler.tearDown(TestShuffleHandler.java:747)
	at sun.reflect.GeneratedMethodAccessor33.invoke(Unknown Source)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.junit.runners.model.FrameworkMethod$1.runReflectiveCall(FrameworkMethod.java:59)
	at org.junit.internal.runners.model.ReflectiveCallable.run(ReflectiveCallable.java:12)
	at org.junit.runners.model.FrameworkMethod.invokeExplosively(FrameworkMethod.java:56)
	at org.junit.internal.runners.statements.RunAfters.invokeMethod(RunAfters.java:46)
	at org.junit.internal.runners.statements.RunAfters.evaluate(RunAfters.java:33)
	at org.junit.rules.TestWatcher$1.evaluate(TestWatcher.java:61)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.BlockJUnit4ClassRunner$1.evaluate(BlockJUnit4ClassRunner.java:100)
	at org.junit.runners.ParentRunner.runLeaf(ParentRunner.java:366)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:103)
	at org.junit.runners.BlockJUnit4ClassRunner.runChild(BlockJUnit4ClassRunner.java:63)
	at org.junit.runners.ParentRunner$4.run(ParentRunner.java:331)
	at org.junit.runners.ParentRunner$1.schedule(ParentRunner.java:79)
	at org.junit.runners.ParentRunner.runChildren(ParentRunner.java:329)
	at org.junit.runners.ParentRunner.access$100(ParentRunner.java:66)
	at org.junit.runners.ParentRunner$2.evaluate(ParentRunner.java:293)
	at org.junit.runners.ParentRunner$3.evaluate(ParentRunner.java:306)
	at org.junit.runners.ParentRunner.run(ParentRunner.java:413)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:137)
	at com.intellij.junit4.JUnit4IdeaTestRunner.startRunnerWithArgs(JUnit4IdeaTestRunner.java:69)
	at com.intellij.rt.junit.IdeaTestRunner$Repeater.startRunnerWithArgs(IdeaTestRunner.java:33)
	at com.intellij.rt.junit.JUnitStarter.prepareStreamsAndStart(JUnitStarter.java:220)
	at com.intellij.rt.junit.JUnitStarter.main(JUnitStarter.java:53)

